{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment - Farm2Home</title>
    <link rel="stylesheet" href="{% static 'css/global-typography.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{% static 'css/checkout.css' %}">
    <link rel="stylesheet" href="{% static 'css/payment.css' %}">
    <link rel="stylesheet" href="{% static 'css/notifications.css' %}">
    <!-- Stripe.js Library (Test Mode) -->
    <script src="https://js.stripe.com/v3/"></script>
</head>
<body>
    <div class="checkout-container">
        <div class="checkout-wrapper">
            <!-- Left Side - Order Items (Same as before) -->
            <div class="order-items-section">
                <button class="back-btn" onclick="goBack()">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
                
                <div class="items-carousel">
                    <div class="carousel-container">
                        <div class="carousel-items" id="carouselItems"></div>
                    </div>
                    <div class="carousel-dots" id="carouselDots"></div>
                </div>
            </div>

            <!-- Right Side - Payment Options -->
            <div class="checkout-form-section">
                <!-- Progress Steps -->
                <div class="progress-steps" data-active="2">
                    <div class="step active" id="step1">
                        <span class="step-number">1</span>
                        <span class="step-label">SHIPPING</span>
                    </div>
                    <div class="step active" id="step2">
                        <span class="step-number">2</span>
                        <span class="step-label">PAYMENT</span>
                    </div>
                    <div class="step" id="step3">
                        <span class="step-number">3</span>
                        <span class="step-label">CONFIRMATION</span>
                    </div>
                </div>

                <!-- Payment Method Toggle -->
                <div class="payment-container">
                    <h2>PAYMENT METHOD</h2>

                    <!-- Payment Toggle Buttons -->
                    <div class="payment-toggle">
                        <button class="toggle-btn active" onclick="switchPaymentMethod('card')" id="cardToggle">
                            <i class="fas fa-credit-card"></i>
                            CARD PAYMENT
                        </button>
                        <button class="toggle-btn" onclick="switchPaymentMethod('cod')" id="codToggle">
                            <i class="fas fa-money-bill-wave"></i>
                            CASH ON DELIVERY
                        </button>
                    </div>

                    <!-- Card Payment Form -->
                    <div class="payment-method active" id="cardPayment">
                        <!-- Credit Card Display -->
                        <div class="card-display" id="cardDisplay">
                            <!-- Top Row: Chip and Logo -->
                            <div class="card-top">
                                <div class="card-chip">
                                    <svg width="40" height="32" viewBox="0 0 40 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect x="2" y="2" width="8" height="8" fill="rgba(255,255,255,0.3)" rx="1"/>
                                        <rect x="2" y="12" width="8" height="8" fill="rgba(255,255,255,0.3)" rx="1"/>
                                        <rect x="12" y="2" width="8" height="8" fill="rgba(255,255,255,0.3)" rx="1"/>
                                        <rect x="12" y="12" width="8" height="8" fill="rgba(255,255,255,0.3)" rx="1"/>
                                        <rect x="22" y="2" width="8" height="8" fill="rgba(255,255,255,0.3)" rx="1"/>
                                        <rect x="22" y="12" width="8" height="8" fill="rgba(255,255,255,0.3)" rx="1"/>
                                    </svg>
                                </div>
                                <div class="card-logo" id="cardLogo">VISA</div>
                            </div>
                            
                            <!-- Middle: Card Number -->
                            <div class="card-number" id="displayCardNumber">•••• •••• •••• ••••</div>
                            
                            <!-- Bottom Row: Details -->
                            <div class="card-details">
                                <div class="card-detail-item">
                                    <span class="card-detail-label">Cardholder Name</span>
                                    <span class="card-detail-value" id="displayCardName">Your Name</span>
                                </div>
                                <div class="card-detail-item">
                                    <span class="card-detail-label">Expiry</span>
                                    <span class="card-detail-value" id="displayExpiryDate">MM/YY</span>
                                </div>
                                <div class="card-detail-item">
                                    <span class="card-detail-label">CVV</span>
                                    <span class="card-detail-value" id="displayCVV">•••</span>
                                </div>
                            </div>
                        </div>

                        <form id="cardPaymentForm" class="payment-form">
                            <div class="form-group">
                                <label>CARD HOLDER NAME</label>
                                <div class="input-wrapper">
                                    <input type="text" id="cardName" placeholder="Anne Jenny" required>
                                </div>
                            </div>

                            <!-- Stripe Card Element Container -->
                            <div class="form-group">
                                <label>CARD DETAILS (SECURE)</label>
                                <div id="card-element" style="background: rgba(255, 255, 255, 0.95); border: 2px solid rgba(255, 255, 255, 0.3); border-radius: 8px;">
                                    <!-- Stripe Card Element will be mounted here -->
                                </div>
                                <div id="card-errors" role="alert" style="color: #fa755a; margin-top: 8px; font-size: 14px;"></div>
                            </div>

                            <div class="payment-footer">
                                <div class="total-section">
                                    <span class="total-label">Total:</span>
                                    <span class="total-amount" id="cardTotal">$727.00</span>
                                </div>
                                <button type="button" class="purchase-btn" onclick="processPayment('card')">
                                    PURCHASE
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Cash on Delivery -->
                    <div class="payment-method" id="codPayment">
                        <div class="cod-section">
                            <div class="cod-card">
                                <!-- Icon -->
                                <div class="cod-icon">
                                    <i class="fas fa-hand-holding-usd"></i>
                                </div>
                                
                                <!-- Content -->
                                <div class="cod-content">
                                    <h3>Cash on Delivery</h3>
                                    <p>Pay when you receive your order</p>
                                    <ul>
                                        <li>No advance payment required</li>
                                        <li>Pay in cash to delivery person</li>
                                        <li>Exact change recommended</li>
                                    </ul>
                                </div>
                                
                                <!-- Total Amount -->
                                <div class="cod-total">
                                    <span class="label">Total</span>
                                    <span class="amount" id="codTotal">$0.00</span>
                                </div>
                            </div>

                            <div class="payment-footer">
                                <div class="total-section">
                                    <span class="total-label">Order Total:</span>
                                    <span class="total-amount" id="codOrderTotal">$0.00</span>
                                </div>
                                <button type="button" class="purchase-btn" onclick="processPayment('cod')">
                                    CONFIRM ORDER
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="{% static 'js/notifications.js' %}"></script>
    <script>
        // Stripe Publishable Key (Test Mode)
        const STRIPE_PUBLIC_KEY = '{{ STRIPE_PUBLIC_KEY }}';
    </script>
    <script src="{% static 'js/payment.js' %}"></script>
</body>
</html>
